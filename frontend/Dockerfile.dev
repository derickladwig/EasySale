# Development Dockerfile for Frontend
# Using Node 22 LTS for latest security patches
FROM node:22-alpine

# Set working directory
WORKDIR /app

# Create data directory for SQLite database
RUN mkdir -p /data && chmod 777 /data

# Install dependencies for hot reload
RUN apk add --no-cache git

# Copy package files
COPY package*.json ./

# Install dependencies (use legacy peer deps for Vite 7 + Storybook 8 compatibility)
RUN npm ci --legacy-peer-deps

# Copy source code (will be overridden by volume mount)
COPY . .

# Expose Vite dev server port
EXPOSE 5173

# Expose Storybook port
EXPOSE 7946

# Start development server (can be overridden by docker-compose command)
CMD ["npm", "run", "dev"]
